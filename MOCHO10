<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Bot de Cuencas Hidrol√≥gicas</title>
    <style>
        body {font-family:Arial,sans-serif; max-width:800px; margin:0 auto; padding:10px;}
        h1 {color:#2196F3; font-size:1.5rem;}
        .topics {background-color:#f0f8ff; padding:10px; border-radius:5px; margin-bottom:10px; font-size:0.9rem;}
        #chatbox {border:1px solid #ddd; height:300px; overflow-y:auto; padding:10px; margin-bottom:10px; background-color:#f9f9f9;}
        .user-message {background-color:#2196F3; color:white; padding:8px; border-radius:5px; margin:5px 0; max-width:80%; margin-left:auto;}
        .bot-message {background-color:#e9e9e9; padding:8px; border-radius:5px; margin:5px 0; max-width:80%;}
        .input-area {display:flex; margin-top:10px; flex-wrap:wrap;}
        #userInput {flex:1; padding:8px; border:1px solid #ddd; border-radius:4px; min-width:200px;}
        button {margin:5px; padding:8px 15px; background-color:#4CAF50; color:white; border:none; border-radius:4px; cursor:pointer;}
        #resetBtn {background-color:#f44336;}
        #muteBtn {background-color:#FF9800;}
        #micBtn {background-color:#9C27B0; opacity:1;}
        #micBtn.listening {
            background-color: #d32f2f;
            animation: pulse 1.5s infinite;
        }
        #mexicoBasinsBtn {background-color:#009688;}
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }
        
        /* Estilo para el aviso y bot√≥n externo */
        .warning-box {
            background-color: #ff9800;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
            text-align: center;
        }
        
        .external-button {
            display: block;
            width: 80%;
            margin: 20px auto;
            padding: 20px;
            background-color: #2196F3;
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .external-button:hover {
            background-color: #0b7dda;
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
            transform: translateY(-2px);
        }
        
        .arrow {
            display: inline-block;
            margin-left: 10px;
            font-size: 20px;
        }

        /* Estilos para el modal de cuencas */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-button:hover {
            color: black;
        }

        .region-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .region-item {
            padding: 10px;
            margin: 5px 0;
            background-color: #f1f1f1;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .region-item:hover {
            background-color: #e0e0e0;
        }

        .basin-list {
            list-style-type: disc;
            padding-left: 20px;
            margin: 10px 0;
        }

        .basin-item {
            padding: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .basin-item:hover {
            background-color: #e0e0e0;
        }

        .region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .expand-icon {
            font-size: 18px;
            transition: transform 0.3s;
        }

        .expanded .expand-icon {
            transform: rotate(90deg);
        }

        .region-description {
            margin: 10px 0;
            line-height: 1.4;
            font-size: 0.95em;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .search-bar {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .basin-content {
            animation: fadeIn 0.5s;
        }

        .basin-detail {
            display: none;
            padding: 10px;
            background-color: #f5f5f5;
            margin-top: 5px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>Chat Bot de Cuencas Hidrol√≥gicas</h1>
    
    <div class="warning-box">
        <h2>‚ö†Ô∏è Versi√≥n con micr√≥fono habilitado</h2>
        <p>Esta versi√≥n incluye funcionalidad completa de reconocimiento de voz.
        Haz clic en el bot√≥n del micr√≥fono para hablar con el bot.</p>
    </div>
    
    <a href="https://tatiyoma57.github.io/WEB_CHAT/" class="external-button" target="_blank">
        üé§ ABRIR VERSI√ìN COMPLETA CON MICR√ìFONO <span class="arrow">‚Üí</span>
    </a>
    
    <div class="topics"><b>Temas:</b> Cuencas hidrol√≥gicas, Hidrolog√≠a, Erosi√≥n, Climatolog√≠a, Cambio clim√°tico</div>
    <div id="chatbox"></div>
    
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Escribe tu mensaje aqu√≠...">
        <button id="sendBtn">Enviar</button>
        <button id="micBtn">üé§ Micr√≥fono</button>
        <button id="muteBtn">Silenciar</button>
        <button id="resetBtn">Reiniciar</button>
        <button id="mexicoBasinsBtn">üåä Cuencas de M√©xico</button>
    </div>
    
    <div class="ai-links">
        <p><b>¬øNecesitas informaci√≥n m√°s espec√≠fica?</b> Utiliza estas herramientas de IA gratuitas:</p>
        <a href="https://chat.openai.com/" target="_blank"><button>ChatGPT</button></a>
        <a href="https://bard.google.com/" target="_blank"><button>Google Bard</button></a>
        <a href="https://www.bing.com/new" target="_blank"><button>Bing Chat</button></a>
        <a href="https://huggingface.co/chat/" target="_blank"><button>HuggingChat</button></a>
    </div>

    <div id="basinsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeModal">&times;</span>
            <h2>Regiones Hidrol√≥gicas de M√©xico</h2>
            <p>Selecciona una regi√≥n para ver sus cuencas:</p>
            <input type="text" id="regionSearch" class="search-bar" placeholder="Buscar regi√≥n o cuenca...">
            <div id="regionsContainer">
                <!-- Las regiones se generar√°n din√°micamente aqu√≠ -->
            </div>
        </div>
    </div>

    <div id="basinDetailModal" class="modal">
        <div class="modal-content">
            <span class="close-button" id="closeBasinDetailModal">&times;</span>
            <h2>Detalles de la Cuenca</h2>
            <div id="basinDetailContent">
                <!-- Detalles de la cuenca se generar√°n din√°micamente aqu√≠ -->
            </div>
        </div>
    </div>

    <script>
        // Variables b√°sicas
        let userName = "";
        let waitingForName = true;
        let isMuted = false;
        let isSearching = false;
        
        // Elementos DOM
        const chatbox = document.getElementById('chatbox');
        const userInput = document.getElementById('userInput');
        const sendBtn = document.getElementById('sendBtn');
        const resetBtn = document.getElementById('resetBtn');
        const muteBtn = document.getElementById('muteBtn');
        const micBtn = document.getElementById('micBtn');
        
        // S√≠ntesis de voz
        const speech = window.speechSynthesis;
        
        // Reconocimiento de voz
        let recognition = null;
        try {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.lang = 'es-ES';
            recognition.continuous = false;
            recognition.interimResults = false;
            
            // Configurar eventos para el reconocimiento de voz
            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                userInput.value = transcript;
                micBtn.classList.remove('listening');
                // Enviar autom√°ticamente el mensaje despu√©s de reconocer la voz
                sendMessage();
            };
            
            recognition.onerror = function(event) {
                console.error('Error en reconocimiento de voz:', event.error);
                micBtn.classList.remove('listening');
            };
            
            recognition.onend = function() {
                micBtn.classList.remove('listening');
                userInput.placeholder = "Escribe tu mensaje aqu√≠...";
            };
            
        } catch(e) {
            console.log('El reconocimiento de voz no est√° disponible en este navegador:', e);
        }
        
        // Base de conocimientos hidrol√≥gicos (versi√≥n reducida para ejemplo)
        const hydrologicalKnowledge = {
            "cuenca": "Una cuenca hidrol√≥gica es un √°rea geogr√°fica donde el agua de lluvia, nieve o deshielo converge en un punto com√∫n, como un r√≠o, lago o el oc√©ano. Es la unidad natural para la gesti√≥n del agua y los recursos naturales.",
            "ciclo hidrol√≥gico": "El ciclo hidrol√≥gico describe el movimiento continuo del agua en, sobre y debajo de la superficie de la Tierra. Incluye procesos de evaporaci√≥n, condensaci√≥n, precipitaci√≥n, infiltraci√≥n, escorrent√≠a y flujo subterr√°neo.",
            "escorrent√≠a": "La escorrent√≠a es el agua de lluvia que fluye sobre la superficie del suelo. Es un componente crucial del ciclo hidrol√≥gico que contribuye al caudal de los r√≠os y puede transportar sedimentos y contaminantes.",
            "infiltraci√≥n": "La infiltraci√≥n es el proceso mediante el cual el agua penetra en el suelo. La tasa de infiltraci√≥n depende de la textura del suelo, su estructura, contenido de humedad previo y compactaci√≥n.",
            "acu√≠fero": "Un acu√≠fero es una formaci√≥n geol√≥gica subterr√°nea que almacena y permite el flujo de agua. Pueden ser libres (con una tabla de agua) o confinados (bajo presi√≥n entre capas impermeables).",
            "modelaci√≥n hidrol√≥gica": "La modelaci√≥n hidrol√≥gica es el proceso de representar matem√°ticamente el comportamiento del agua en una cuenca. Los modelos pueden ser conceptuales, f√≠sicos o de caja negra, y se utilizan para predecir caudales, inundaciones o calidad del agua.",
            "erosi√≥n h√≠drica": "La erosi√≥n h√≠drica es el proceso de degradaci√≥n del suelo causado por el agua. Incluye erosi√≥n por salpicadura, laminar, en surcos y c√°rcavas, y afecta la productividad del suelo y calidad del agua.",
            "cambio clim√°tico": "El cambio clim√°tico est√° alterando los patrones hidrol√≥gicos globales, modificando la intensidad y frecuencia de precipitaciones, aumentando eventos extremos y afectando la disponibilidad de agua en muchas regiones."
        };
        
        // Base de datos de regiones hidrol√≥gicas de M√©xico y sus cuencas
        const mexicanHydrologicalRegions = {
            "RH01 - Baja California Noroeste": {
                description: "Regi√≥n √°rida que abarca la parte noroeste de Baja California. Incluye importantes cuencas como el R√≠o Tijuana y est√° caracterizada por un clima seco y escasa precipitaci√≥n anual. Precipitaci√≥n promedio: 200 mm/a√±o. √Årea: 25,000 km¬≤. Vegetaci√≥n: xer√≥fila.",
                basins: [
                    { name: "R√≠o Tijuana", details: "Cuenca que abastece a la ciudad de Tijuana, con un √°rea de 1,500 km¬≤. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Las Palmas", details: "Cuenca peque√±a que desemboca en el Oc√©ano Pac√≠fico. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o Guadalupe", details: "R√≠o que cruza la regi√≥n y es importante para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o El Descanso", details: "R√≠o intermitente que se alimenta de lluvias estacionales. Caudal variable." },
                    { name: "R√≠o San Miguel", details: "Cuenca que se caracteriza por su escaso caudal. Caudal promedio: 0.5 m¬≥/s." },
                    { name: "Arroyo Escopeta", details: "Arroyo que se seca en temporadas de sequ√≠a. Caudal variable." },
                    { name: "Arroyo San Rafael", details: "Arroyo que fluye hacia el Oc√©ano Pac√≠fico. Caudal promedio: 0.8 m¬≥/s." },
                    { name: "Arroyo San Telmo", details: "Arroyo que presenta un caudal variable. Caudal promedio: 0.6 m¬≥/s." },
                    { name: "Arroyo Santo Tom√°s", details: "Arroyo que es importante para la fauna local. Caudal variable." },
                    { name: "Arroyo San Vicente", details: "Arroyo que se utiliza para riego. Caudal promedio: 0.7 m¬≥/s." }
                ]
            },
            "RH02 - Baja California Centro-Oeste": {
                description: "Comprende la zona central occidental de la pen√≠nsula. Sus cuencas son principalmente arroyos intermitentes con r√©gimen de flujo espor√°dico dependiente de lluvias estacionales. Precipitaci√≥n promedio: 300 mm/a√±o. √Årea: 15,000 km¬≤. Vegetaci√≥n: matorral.",
                basins: [
                    { name: "Arroyo San Fernando", details: "Arroyo que se seca en verano. Caudal promedio: 2 m¬≥/s." },
                    { name: "Arroyo San Andr√©s", details: "Arroyo intermitente que fluye durante la temporada de lluvias. Caudal variable." },
                    { name: "Arroyo Calamaju√©", details: "Arroyo que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "Arroyo Santa Isabel", details: "Arroyo que presenta un caudal variable. Caudal promedio: 1 m¬≥/s." },
                    { name: "Arroyo Las √Ånimas", details: "Arroyo que se utiliza para riego. Caudal promedio: 1.2 m¬≥/s." },
                    { name: "Arroyo Santa Clara", details: "Arroyo que desemboca en el Oc√©ano Pac√≠fico. Caudal variable." }
                ]
            },
            "RH03 - Baja California Suroeste": {
                description: "Ubicada en el suroeste peninsular, esta regi√≥n incluye varios arroyos importantes que desembocan en el Oc√©ano Pac√≠fico. El clima es semi√°rido con vegetaci√≥n principalmente xer√≥fila. Precipitaci√≥n promedio: 400 mm/a√±o. √Årea: 20,000 km¬≤. Vegetaci√≥n: desierto.",
                basins: [
                    { name: "Arroyo R√≠o San Ignacio", details: "Arroyo que es importante para la agricultura local. Caudal promedio: 4 m¬≥/s." },
                    { name: "Arroyo La Pur√≠sima", details: "Arroyo que desemboca en el Oc√©ano Pac√≠fico. Caudal promedio: 3 m¬≥/s." },
                    { name: "Arroyo San Gregorio", details: "Arroyo que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "Arroyo Cadej√©", details: "Arroyo que se seca en verano. Caudal variable." },
                    { name: "Arroyo Santa √Ågueda", details: "Arroyo que es importante para la fauna local. Caudal promedio: 1.8 m¬≥/s." }
                ]
            },
            "RH04 - Baja California Noreste": {
                description: "Dominada por el delta del R√≠o Colorado y zonas des√©rticas. Es una regi√≥n con alta importancia ecol√≥gica y para la conservaci√≥n de especies end√©micas del desierto. Precipitaci√≥n promedio: 150 mm/a√±o. √Årea: 30,000 km¬≤. Vegetaci√≥n: desierto.",
                basins: [
                    { name: "R√≠o Colorado", details: "R√≠o que forma parte de la frontera entre M√©xico y EE.UU. Caudal promedio: 1,500 m¬≥/s." },
                    { name: "Cuenca Laguna Salada", details: "Cuenca que es importante para la biodiversidad. Caudal variable." },
                    { name: "Desierto de Altar", details: "Zona √°rida con escasa vegetaci√≥n. Caudal variable." }
                ]
            },
            "RH05 - Baja California Centro-Este": {
                description: "Comprende la parte central de la pen√≠nsula hacia el Golfo de California. Incluye oasis importantes y arroyos que son vitales para los ecosistemas locales. Precipitaci√≥n promedio: 250 mm/a√±o. √Årea: 18,000 km¬≤. Vegetaci√≥n: matorral y oasis.",
                basins: [
                    { name: "Arroyo Las V√≠rgenes", details: "Arroyo que es importante para la fauna local. Caudal promedio: 1.2 m¬≥/s." },
                    { name: "Arroyo Muleg√©", details: "Arroyo que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "Arroyo Comond√∫", details: "Arroyo que presenta un caudal variable. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH06 - Baja California Sureste": {
                description: "Regi√≥n que abarca la parte sureste de la pen√≠nsula. Sus arroyos son fundamentales para el abastecimiento de agua en zonas tur√≠sticas como Los Cabos y La Paz. Precipitaci√≥n promedio: 350 mm/a√±o. √Årea: 22,000 km¬≤. Vegetaci√≥n: matorral y palmeras.",
                basins: [
                    { name: "Arroyo Santiago", details: "Arroyo que es importante para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "Arroyo Todos Santos", details: "Arroyo que desemboca en el Oc√©ano Pac√≠fico. Caudal promedio: 2 m¬≥/s." },
                    { name: "Arroyo La Paz", details: "Arroyo que presenta un caudal variable. Caudal promedio: 1.8 m¬≥/s." },
                    { name: "Arroyo San Jos√© del Cabo", details: "Arroyo que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "Arroyo San Bruno", details: "Arroyo que se utiliza para riego. Caudal promedio: 1.2 m¬≥/s." }
                ]
            },
            "RH07 - R√≠o Colorado": {
                description: "Comprende principalmente el delta del R√≠o Colorado en territorio mexicano. Es una zona de gran importancia ecol√≥gica y para los acuerdos binacionales de agua entre M√©xico y EE.UU. Precipitaci√≥n promedio: 100 mm/a√±o. √Årea: 40,000 km¬≤. Vegetaci√≥n: desierto y humedales.",
                basins: [
                    { name: "R√≠o Colorado", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 1,500 m¬≥/s." },
                    { name: "Delta del R√≠o Colorado", details: "Zona ecol√≥gica con alta biodiversidad. Caudal variable." }
                ]
            },
            "RH08 - Sonora Norte": {
                description: "Ubicada en el norte de Sonora, incluye cuencas que nacen en la Sierra Madre Occidental. La regi√≥n enfrenta desaf√≠os de escasez de agua y sobreexplotaci√≥n de acu√≠feros. Precipitaci√≥n promedio: 500 mm/a√±o. √Årea: 35,000 km¬≤. Vegetaci√≥n: bosque templado.",
                basins: [
                    { name: "R√≠o Sonoyta", details: "R√≠o que es importante para la fauna local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Concepci√≥n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Asunci√≥n", details: "R√≠o que se utiliza para riego. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o San Ignacio", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 1.2 m¬≥/s." }
                ]
            },
            "RH09 - Sonora Sur": {
                description: "Abarca la porci√≥n sur del estado de Sonora, con r√≠os que son vitales para la agricultura y desarrollo econ√≥mico regional. El R√≠o Yaqui es particularmente importante para irrigaci√≥n. Precipitaci√≥n promedio: 600 mm/a√±o. √Årea: 28,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Sonora", details: "R√≠o que es importante para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o San Miguel", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o M√°tape", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Yaqui", details: "R√≠o vital para la irrigaci√≥n. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Mayo", details: "R√≠o que es importante para la fauna local. Caudal promedio: 2.5 m¬≥/s." }
                ]
            },
            "RH10 - Sinaloa": {
                description: "Una de las regiones hidrol√≥gicas m√°s productivas de M√©xico. Sus r√≠os sustentan importantes distritos de riego que producen gran parte de las hortalizas del pa√≠s. Precipitaci√≥n promedio: 800 mm/a√±o. √Årea: 50,000 km¬≤. Vegetaci√≥n: cultivos y matorral.",
                basins: [
                    { name: "R√≠o Fuerte", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Sinaloa", details: "R√≠o que presenta un caudal variable. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Culiac√°n", details: "R√≠o que se utiliza para riego. Caudal promedio: 7 m¬≥/s." },
                    { name: "R√≠o San Lorenzo", details: "R√≠o que es importante para la fauna local. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Elota", details: "R√≠o que se utiliza para riego. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Piaxtla", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Quelite", details: "R√≠o que presenta un caudal variable. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Presidio", details: "R√≠o que es importante para la fauna local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Baluarte", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." }
                ]
            },
            "RH11 - Presidio-San Pedro": {
                description: "Regi√≥n que comprende cuencas compartidas entre Sinaloa, Durango y Nayarit. Sus r√≠os son importantes para la generaci√≥n hidroel√©ctrica y actividades agr√≠colas. Precipitaci√≥n promedio: 700 mm/a√±o. √Årea: 30,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Presidio", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Baluarte", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Acaponeta", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o San Pedro", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH12 - Lerma-Santiago": {
                description: "Una de las regiones hidrol√≥gicas m√°s importantes del pa√≠s. El sistema Lerma-Chapala-Santiago atraviesa cinco estados y abastece a m√°s de 15 millones de personas. Precipitaci√≥n promedio: 900 mm/a√±o. √Årea: 60,000 km¬≤. Vegetaci√≥n: bosque y cultivos.",
                basins: [
                    { name: "R√≠o Lerma", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 20 m¬≥/s." },
                    { name: "Lago de Chapala", details: "Lago m√°s grande de M√©xico. Caudal variable." },
                    { name: "R√≠o Santiago", details: "R√≠o que presenta un caudal variable. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o Zula", details: "R√≠o que se utiliza para riego. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Verde", details: "R√≠o que es importante para la fauna local. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Juchipila", details: "R√≠o que presenta un caudal variable. Caudal promedio: 7 m¬≥/s." },
                    { name: "R√≠o Bola√±os", details: "R√≠o que se utiliza para riego. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Huaynamota", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Mololoa", details: "R√≠o que presenta un caudal variable. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Grande de Santiago", details: "R√≠o que es importante para la fauna local. Caudal promedio: 3 m¬≥/s." }
                ]
            },
            "RH13 - R√≠o Huicicila": {
                description: "Peque√±a regi√≥n ubicada en la costa de Nayarit. Sus cuencas son cortas pero con caudales importantes debido a la alta precipitaci√≥n de la zona. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 5,000 km¬≤. Vegetaci√≥n: selva tropical.",
                basins: [
                    { name: "R√≠o Huicicila", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o San Blas", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Santiago-Aguamilpa", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH14 - R√≠o Ameca": {
                description: "Abarca partes de Jalisco y Nayarit, con el R√≠o Ameca como corriente principal. Sus recursos h√≠dricos son fundamentales para el desarrollo tur√≠stico de Puerto Vallarta. Precipitaci√≥n promedio: 1,000 mm/a√±o. √Årea: 10,000 km¬≤. Vegetaci√≥n: selva y matorral.",
                basins: [
                    { name: "R√≠o Ameca", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Mascota", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Cuale", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Pitillal", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Tomatl√°n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH15 - Costa de Jalisco": {
                description: "Comprende r√≠os que nacen en la Sierra Madre del Sur y desembocan en el Pac√≠fico. La regi√≥n es importante para la conservaci√≥n de ecosistemas costeros y manglar. Precipitaci√≥n promedio: 1,500 mm/a√±o. √Årea: 12,000 km¬≤. Vegetaci√≥n: manglares y selva.",
                basins: [
                    { name: "R√≠o Purificaci√≥n", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Cihuatl√°n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o San Nicol√°s", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Cuitzmala", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Marabasco", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH16 - Armer√≠a-Coahuayana": {
                description: "Ubicada entre Colima, Jalisco y Michoac√°n. Sus r√≠os son esenciales para la agricultura local y presentan un r√©gimen perenne debido a las lluvias consistentes en la zona. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 15,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Armer√≠a", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Coahuayana", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Tuxpan", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH17 - Costa de Michoac√°n": {
                description: "Regi√≥n costera con cuencas de tama√±o medio que desembocan en el Pac√≠fico. Presenta importantes desaf√≠os de conservaci√≥n y manejo sostenible del agua. Precipitaci√≥n promedio: 1,000 mm/a√±o. √Årea: 20,000 km¬≤. Vegetaci√≥n: selva y manglares.",
                basins: [
                    { name: "R√≠o Nexpa", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Ostula", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Aquila", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Coahuayana", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH18 - Balsas": {
                description: "Una de las cuencas m√°s grandes del pa√≠s, abarca siete estados. El R√≠o Balsas y sus afluentes son cruciales para la generaci√≥n hidroel√©ctrica y el desarrollo agr√≠cola regional. Precipitaci√≥n promedio: 800 mm/a√±o. √Årea: 70,000 km¬≤. Vegetaci√≥n: bosque y cultivos.",
                basins: [
                    { name: "R√≠o Balsas", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 20 m¬≥/s." },
                    { name: "R√≠o Tepalcatepec", details: "R√≠o que presenta un caudal variable. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o Cutzamala", details: "R√≠o que se utiliza para riego. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Amacuzac", details: "R√≠o que es importante para la fauna local. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Grande de Iguala", details: "R√≠o que presenta un caudal variable. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Atoyac", details: "R√≠o que se utiliza para riego. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Mixteco", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Tlapaneco", details: "R√≠o que presenta un caudal variable. Caudal promedio: 3 m¬≥/s." }
                ]
            },
            "RH19 - Costa Grande de Guerrero": {
                description: "Comprende los r√≠os de la Costa Grande de Guerrero que descienden de la Sierra Madre del Sur. Son cuencas cortas pero con caudales importantes por la orograf√≠a de la regi√≥n. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 18,000 km¬≤. Vegetaci√≥n: selva y matorral.",
                basins: [
                    { name: "R√≠o Coyuquilla", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Ixtapa", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o San Jeronimito", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Petatl√°n", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o Coyuca", details: "R√≠o que presenta un caudal variable. Caudal promedio: 0.8 m¬≥/s." },
                    { name: "R√≠o Atoyac", details: "R√≠o que se utiliza para riego. Caudal promedio: 0.6 m¬≥/s." }
                ]
            },
            "RH20 - Costa Chica de Guerrero": {
                description: "Abarca los r√≠os de la Costa Chica guerrerense. La regi√≥n enfrenta problemas de deforestaci√≥n que afectan el r√©gimen hidrol√≥gico de sus cuencas. Precipitaci√≥n promedio: 1,000 mm/a√±o. √Årea: 16,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Nexpa", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Copala", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Marquelia", details: "R√≠o que se utiliza para riego. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o Papagayo", details: "R√≠o que es importante para la fauna local. Caudal promedio: 0.8 m¬≥/s." },
                    { name: "R√≠o de la Sabana", details: "R√≠o que presenta un caudal variable. Caudal promedio: 0.6 m¬≥/s." },
                    { name: "R√≠o Coyuca", details: "R√≠o que se utiliza para riego. Caudal promedio: 0.5 m¬≥/s." }
                ]
            },
            "RH21 - Costa de Oaxaca": {
                description: "Incluye r√≠os importantes de la costa oaxaque√±a. El R√≠o Verde es la cuenca m√°s importante y presenta caudales significativos en temporada de lluvias. Precipitaci√≥n promedio: 1,500 mm/a√±o. √Årea: 25,000 km¬≤. Vegetaci√≥n: selva y manglares.",
                basins: [
                    { name: "R√≠o Verde", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Colotepec", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Copalita", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Tehuantepec", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH22 - Tehuantepec": {
                description: "Regi√≥n centrada en el R√≠o Tehuantepec y su cuenca. Tiene gran importancia hist√≥rica y cultural, adem√°s de ser zona de transici√≥n entre ecosistemas del Golfo y el Pac√≠fico. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 30,000 km¬≤. Vegetaci√≥n: selva y matorral.",
                basins: [
                    { name: "R√≠o Tehuantepec", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Mixteco", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Coatzacoalcos (porci√≥n)", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." }
                ]
            },
            "RH23 - Costa de Chiapas": {
                description: "Comprende los r√≠os de la costa chiapaneca, incluyendo el Suchiate en la frontera con Guatemala. La regi√≥n recibe alta precipitaci√≥n y sus cuencas son propensas a inundaciones. Precipitaci√≥n promedio: 1,800 mm/a√±o. √Årea: 22,000 km¬≤. Vegetaci√≥n: selva tropical.",
                basins: [
                    { name: "R√≠o Suchiate", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Cahoac√°n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Coat√°n", details: "R√≠o que se utiliza para riego. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Huixtla", details: "R√≠o que es importante para la fauna local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Huehuet√°n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Pijijiapan", details: "R√≠o que se utiliza para riego. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH24 - Bravo-Conchos": {
                description: "Una de las regiones m√°s extensas, incluye la cuenca compartida del R√≠o Bravo/Grande con EE.UU. Enfrenta grandes desaf√≠os de escasez y distribuci√≥n equitativa del agua. Precipitaci√≥n promedio: 600 mm/a√±o. √Årea: 50,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Bravo", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o Conchos", details: "R√≠o que presenta un caudal variable. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o San Juan", details: "R√≠o que se utiliza para riego. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o San Rodrigo", details: "R√≠o que es importante para la fauna local. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o √Ålamo", details: "R√≠o que presenta un caudal variable. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Sabinas", details: "R√≠o que se utiliza para riego. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Salado", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." }
                ]
            },
            "RH25 - San Fernando-Soto la Marina": {
                description: "Ubicada en Tamaulipas, sus r√≠os desembocan en el Golfo de M√©xico. La regi√≥n es importante para la pesca y conservaci√≥n de humedales costeros. Precipitaci√≥n promedio: 700 mm/a√±o. √Årea: 20,000 km¬≤. Vegetaci√≥n: humedales y matorral.",
                basins: [
                    { name: "R√≠o San Fernando", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Soto la Marina", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Purificaci√≥n", details: "R√≠o que se utiliza para riego. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Corona", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o San Carlos", details: "R√≠o que presenta un caudal variable. Caudal promedio: 0.8 m¬≥/s." }
                ]
            },
            "RH26 - P√°nuco": {
                description: "Extensa regi√≥n que abarca cinco estados del centro-este de M√©xico. El sistema del R√≠o P√°nuco es vital para el abastecimiento de agua a zonas urbanas e industriales. Precipitaci√≥n promedio: 800 mm/a√±o. √Årea: 45,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o P√°nuco", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Tames√≠", details: "R√≠o que presenta un caudal variable. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Moctezuma", details: "R√≠o que se utiliza para riego. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Santa Mar√≠a", details: "R√≠o que es importante para la fauna local. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Tempoal", details: "R√≠o que presenta un caudal variable. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o Ext√≥raz", details: "R√≠o que se utiliza para riego. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Verde", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Tampa√≥n", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH27 - Tuxpan-Nautla": {
                description: "Comprende varios r√≠os de la vertiente este del Golfo. Se caracteriza por cuencas cortas pero caudalosas debido a la alta precipitaci√≥n en la Sierra Madre Oriental. Precipitaci√≥n promedio: 1,000 mm/a√±o. √Årea: 18,000 km¬≤. Vegetaci√≥n: selva y matorral.",
                basins: [
                    { name: "R√≠o Tuxpan", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Cazones", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "R√≠o Tecolutla", details: "R√≠o que se utiliza para riego. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Nautla", details: "R√≠o que es importante para la fauna local. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Misantla", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1 m¬≥/s." }
                ]
            },
            "RH28 - Papaloapan": {
                description: "Una de las regiones con mayor abundancia h√≠drica del pa√≠s. El sistema del Papaloapan drena extensas zonas de Oaxaca, Puebla y Veracruz, creando humedales de gran importancia. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 55,000 km¬≤. Vegetaci√≥n: humedales y cultivos.",
                basins: [
                    { name: "R√≠o Papaloapan", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o Santo Domingo", details: "R√≠o que presenta un caudal variable. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Valle Nacional", details: "R√≠o que se utiliza para riego. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Tonto", details: "R√≠o que es importante para la fauna local. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Blanco", details: "R√≠o que presenta un caudal variable. Caudal promedio: 5 m¬≥/s." },
                    { name: "R√≠o Obispo", details: "R√≠o que se utiliza para riego. Caudal promedio: 4 m¬≥/s." },
                    { name: "R√≠o San Juan", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." }
                ]
            },
            "RH29 - Coatzacoalcos": {
                description: "Centrada en la cuenca del R√≠o Coatzacoalcos en el sur de Veracruz. Es una regi√≥n de alta precipitaci√≥n y biodiversidad, vital para la industria petrolera del pa√≠s. Precipitaci√≥n promedio: 1,500 mm/a√±o. √Årea: 30,000 km¬≤. Vegetaci√≥n: selva y manglares.",
                basins: [
                    { name: "R√≠o Coatzacoalcos", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 20 m¬≥/s." },
                    { name: "R√≠o Uxpanapa", details: "R√≠o que presenta un caudal variable. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o Coachapa", details: "R√≠o que se utiliza para riego. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o Calzadas", details: "R√≠o que es importante para la fauna local. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Tonal√°", details: "R√≠o que presenta un caudal variable. Caudal promedio: 6 m¬≥/s." }
                ]
            },
            "RH30 - Grijalva-Usumacinta": {
                description: "La regi√≥n con mayor disponibilidad de agua en M√©xico. Sus r√≠os forman la frontera parcial con Guatemala y son claves para la generaci√≥n hidroel√©ctrica y conservaci√≥n de selvas tropicales. Precipitaci√≥n promedio: 1,800 mm/a√±o. √Årea: 80,000 km¬≤. Vegetaci√≥n: selva tropical.",
                basins: [
                    { name: "R√≠o Grijalva", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 25 m¬≥/s." },
                    { name: "R√≠o Usumacinta", details: "R√≠o que presenta un caudal variable. Caudal promedio: 20 m¬≥/s." },
                    { name: "R√≠o Lacant√∫n", details: "R√≠o que se utiliza para riego. Caudal promedio: 15 m¬≥/s." },
                    { name: "R√≠o de la Pasi√≥n", details: "R√≠o que es importante para la fauna local. Caudal promedio: 12 m¬≥/s." },
                    { name: "R√≠o Chixoy", details: "R√≠o que presenta un caudal variable. Caudal promedio: 10 m¬≥/s." },
                    { name: "R√≠o San Pedro", details: "R√≠o que se utiliza para riego. Caudal promedio: 8 m¬≥/s." },
                    { name: "R√≠o Lacanj√°", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 6 m¬≥/s." },
                    { name: "R√≠o Tzendales", details: "R√≠o que presenta un caudal variable. Caudal promedio: 5 m¬≥/s." }
                ]
            },
            "RH31 - Yucat√°n Oeste": {
                description: "Ubicada en Campeche, esta regi√≥n tiene pocos r√≠os superficiales debido a la geolog√≠a c√°rstica. El R√≠o Candelaria es su corriente principal y forma importantes humedales. Precipitaci√≥n promedio: 1,000 mm/a√±o. √Årea: 10,000 km¬≤. Vegetaci√≥n: selva y humedales.",
                basins: [
                    { name: "R√≠o Champot√≥n", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Candelaria", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." },
                    { name: "R√≠o Mamantel", details: "R√≠o que se utiliza para riego. Caudal promedio: 1 m¬≥/s." },
                    { name: "R√≠o Palizada", details: "R√≠o que es importante para la fauna local. Caudal promedio: 0.8 m¬≥/s." }
                ]
            },
            "RH32 - Yucat√°n Norte": {
                description: "Comprende la mayor parte de la pen√≠nsula de Yucat√°n. Se caracteriza por la ausencia de r√≠os superficiales, con un sistema hidrol√≥gico dominado por cenotes y r√≠os subterr√°neos. Precipitaci√≥n promedio: 800 mm/a√±o. √Årea: 12,000 km¬≤. Vegetaci√≥n: selva y cenotes.",
                basins: [
                    { name: "Cuenca Cerrada Principal", details: "Zona con cenotes importantes. Caudal variable." },
                    { name: "Regi√≥n de Cenotes", details: "Sistema de r√≠os subterr√°neos. Caudal variable." },
                    { name: "Regi√≥n Norte de Yucat√°n", details: "Zona con escasa vegetaci√≥n. Caudal variable." }
                ]
            },
            "RH33 - Yucat√°n Este": {
                description: "Localizada en Quintana Roo, incluye sistemas lagunares importantes como Bacalar. La regi√≥n posee una compleja red de r√≠os subterr√°neos que desembocan en el Mar Caribe. Precipitaci√≥n promedio: 1,200 mm/a√±o. √Årea: 15,000 km¬≤. Vegetaci√≥n: selva y manglares.",
                basins: [
                    { name: "Cuenca Bah√≠a de Chetumal", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 3 m¬≥/s." },
                    { name: "Cuenca R√≠o Hondo", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2.5 m¬≥/s." },
                    { name: "Sistema Lagunar Bacalar", details: "Sistema de lagunas que es importante para la fauna local. Caudal variable." }
                ]
            },
            "RH34 - Cuencas Cerradas del Norte": {
                description: "Regi√≥n √°rida del norte del pa√≠s sin salida al mar. Sus escasas corrientes terminan en lagos y lagunas interiores que frecuentemente se secan por evaporaci√≥n. Precipitaci√≥n promedio: 200 mm/a√±o. √Årea: 8,000 km¬≤. Vegetaci√≥n: desierto.",
                basins: [
                    { name: "Cuenca Cerrada del Bols√≥n de Mapim√≠", details: "Zona √°rida con escasa vegetaci√≥n. Caudal variable." },
                    { name: "El Llano", details: "Zona con lagunas interiores. Caudal variable." },
                    { name: "Laguna de Tlahualilo", details: "Laguna que se seca en verano. Caudal variable." },
                    { name: "Arroyo La India", details: "Arroyo que presenta un caudal variable. Caudal promedio: 0.5 m¬≥/s." }
                ]
            },
            "RH35 - Mapim√≠": {
                description: "Ubicada en la regi√≥n des√©rtica del norte, sus cuencas desembocan en lagunas interiores. La regi√≥n enfrenta graves problemas de disponibilidad y calidad del agua. Precipitaci√≥n promedio: 150 mm/a√±o. √Årea: 5,000 km¬≤. Vegetaci√≥n: desierto.",
                basins: [
                    { name: "Laguna de Mayr√°n", details: "Laguna que se seca en verano. Caudal variable." },
                    { name: "Laguna de Viesca", details: "Laguna que presenta un caudal variable. Caudal promedio: 0.5 m¬≥/s." },
                    { name: "R√≠o Nazas", details: "R√≠o que es vital para la agricultura local. Caudal promedio: 2 m¬≥/s." },
                    { name: "R√≠o Aguanaval", details: "R√≠o que presenta un caudal variable. Caudal promedio: 1.5 m¬≥/s." }
                ]
            },
            "RH36 - Nazas-Aguanaval": {
                description: "Comprende las cuencas de los r√≠os Nazas y Aguanaval que abastecen a la Comarca Lagunera. Es una regi√≥n con alta presi√≥n sobre los recursos h√≠dricos debido a la agricultura intensiva. Precipitaci√≥n promedio: 300 mm/a√±o. √Årea: 10,000 km¬≤. Vegetaci√≥n: matorral y cultivos.",
                basins: [
                    { name: "R√≠o Nazas", details: "R√≠o que es vital para el suministro de agua en la regi√≥n. Caudal promedio: 3 m¬≥/s." },
                    { name: "R√≠o Aguanaval", details: "R√≠o que presenta un caudal variable. Caudal promedio: 2 m¬≥/s." },
                    { name: "Presa L√°zaro C√°rdenas", details: "Presa que es importante para la agricultura local. Caudal variable." }
                ]
            },
            "RH37 - El Salado": {
                description: "Extensa regi√≥n √°rida del centro-norte de M√©xico. Es una cuenca endorreica con escasas corrientes permanentes y alta presi√≥n sobre los acu√≠feros para consumo urbano y agr√≠cola. Precipitaci√≥n promedio: 100 mm/a√±o. √Årea: 12,000 km¬≤. Vegetaci√≥n: desierto.",
                basins: [
                    { name: "Valle de Arista", details: "Zona √°rida con escasa vegetaci√≥n. Caudal variable." },
                    { name: "Cuenca Sierra de Rodr√≠guez", details: "Zona con lagunas interiores. Caudal variable." },
                    { name: "Presa San Jos√©", details: "Presa que se utiliza para riego. Caudal variable." },
                    { name: "Valle de San Luis Potos√≠", details: "Zona que presenta un caudal variable. Caudal promedio: 0.5 m¬≥/s." },
                    { name: "Fresnillo-Yesca", details: "Zona que es importante para la fauna local. Caudal variable." }
                ]
            }
        };

        // Funci√≥n para mostrar el modal de cuencas
        function showMexicanWatershedsModal() {
            const modal = document.getElementById('basinsModal');
            const closeBtn = document.getElementById('closeModal');
            const regionsContainer = document.getElementById('regionsContainer');
            const searchInput = document.getElementById('regionSearch');
            
            regionsContainer.innerHTML = '';
            
            Object.entries(mexicanHydrologicalRegions).forEach(([regionName, regionData]) => {
                const basins = regionData.basins;
                const description = regionData.description;
                
                const regionDiv = document.createElement('div');
                regionDiv.className = 'region-item';
                regionDiv.innerHTML = `
                    <div class="region-header">
                        <span>${regionName}</span>
                        <span class="expand-icon">‚Ä∫</span>
                    </div>
                    <div class="basin-content" style="display:none; padding:10px; background-color:#f5f5f5; margin-top:5px; border-radius:4px;">
                        <p class="region-description">${description}</p>
                        <h4>Cuencas principales:</h4>
                        <ul class="basin-list">
                            ${basins.map(basin => `<li class="basin-item" onclick="showBasinDetail('${basin.name}')">${basin.name}</li>`).join('')}
                        </ul>
                    </div>
                `;
                
                regionDiv.querySelector('.region-header').addEventListener('click', () => {
                    const content = regionDiv.querySelector('.basin-content');
                    if (content.style.display === 'none') {
                        content.style.display = 'block';
                        regionDiv.classList.add('expanded');
                    } else {
                        content.style.display = 'none';
                        regionDiv.classList.remove('expanded');
                    }
                });
                
                regionsContainer.appendChild(regionDiv);
            });
            
            searchInput.addEventListener('input', () => {
                const searchTerm = searchInput.value.toLowerCase();
                
                Array.from(regionsContainer.querySelectorAll('.region-item')).forEach(regionItem => {
                    const regionName = regionItem.querySelector('.region-header span').textContent.toLowerCase();
                    const basins = Array.from(regionItem.querySelectorAll('.basin-item')).map(item => item.textContent.toLowerCase());
                    const description = regionItem.querySelector('.region-description').textContent.toLowerCase();
                    
                    const regionMatch = regionName.includes(searchTerm);
                    const basinMatch = basins.some(basin => basin.includes(searchTerm));
                    const descriptionMatch = description.includes(searchTerm);
                    
                    regionItem.style.display = (regionMatch || basinMatch || descriptionMatch) ? 'block' : 'none';
                    
                    if ((basinMatch || descriptionMatch) && searchTerm.length > 2) {
                        regionItem.querySelector('.basin-content').style.display = 'block';
                        regionItem.classList.add('expanded');
                    } else if (searchTerm.length <= 2 && !regionMatch) {
                        regionItem.querySelector('.basin-content').style.display = 'none';
                        regionItem.classList.remove('expanded');
                    }
                });
            });
            
            modal.style.display = 'block';
            
            closeBtn.onclick = function() {
                modal.style.display = 'none';
            };
            
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            };
        }

        // Funci√≥n para mostrar detalles de la cuenca
        function showBasinDetail(basinName) {
            const basinDetailModal = document.getElementById('basinDetailModal');
            const closeBasinDetailBtn = document.getElementById('closeBasinDetailModal');
            const basinDetailContent = document.getElementById('basinDetailContent');
            
            // Buscar la cuenca en las regiones
            for (const region of Object.values(mexicanHydrologicalRegions)) {
                const basin = region.basins.find(b => b.name === basinName);
                if (basin) {
                    basinDetailContent.innerHTML = `
                        <h3>${basin.name}</h3>
                        <p>${basin.details}</p>
                    `;
                    break;
                }
            }
            
            basinDetailModal.style.display = 'block';
            
            closeBasinDetailBtn.onclick = function() {
                basinDetailModal.style.display = 'none';
            };
            
            window.onclick = function(event) {
                if (event.target == basinDetailModal) {
                    basinDetailModal.style.display = 'none';
                }
            };
        }

        // Funci√≥n para obtener informaci√≥n general sobre cuencas hidrol√≥gicas de M√©xico
        function getMexicanWatersheds() {
            showMexicanWatershedsModal();
        }
        
        // Funci√≥n para obtener coordenadas de una ubicaci√≥n (geocoding)
        async function getLocationCoordinates(location) {
            try {
                const response = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(location)}&count=1&language=es&format=json`);
                
                if (!response.ok) {
                    throw new Error(`Error en geocoding: ${response.status}`);
                }
                
                const data = await response.json();
                console.log("Datos de geocoding:", data);
                
                if (data.results && data.results.length > 0) {
                    return {
                        name: data.results[0].name,
                        latitude: data.results[0].latitude,
                        longitude: data.results[0].longitude,
                        country: data.results[0].country,
                        admin1: data.results[0].admin1 // Estado/provincia
                    };
                }
                
                return null;
            } catch (error) {
                console.error("Error obteniendo coordenadas:", error);
                return null;
            }
        }

        // Funci√≥n para obtener datos clim√°ticos actuales
        async function fetchWeatherData(location) {
            try {
                console.log("Buscando clima para:", location);
                
                // 1. Obtener coordenadas
                const coordinates = await getLocationCoordinates(location);
                
                if (!coordinates) {
                    console.error("No se encontraron coordenadas para:", location);
                    return null;
                }
                
                // 2. Obtener clima con las coordenadas
                const weatherUrl = `https://api.open-meteo.com/v1/forecast?latitude=${coordinates.latitude}&longitude=${coordinates.longitude}&current=temperature_2m,relative_humidity_2m,apparent_temperature,is_day,precipitation,rain,weather_code,wind_speed_10m&hourly=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto&forecast_days=1`;
                
                const response = await fetch(weatherUrl);
                
                if (!response.ok) {
                    throw new Error(`Error obteniendo clima: ${response.status}`);
                }
                
                const weatherData = await response.json();
                console.log("Datos de clima:", weatherData);
                
                // A√±adir informaci√≥n de ubicaci√≥n a los datos clim√°ticos
                return {
                    ...weatherData,
                    location: coordinates
                };
                
            } catch (error) {
                console.error("Error detallado:", error);
                return null;
            }
        }

        // Funci√≥n para obtener pron√≥stico para varios d√≠as
        async function fetchForecastData(location) {
            try {
                console.log("Buscando pron√≥stico para:", location);
                
                // 1. Obtener coordenadas
                const coordinates = await getLocationCoordinates(location);
                
                if (!coordinates) {
                    console.error("No se encontraron coordenadas para:", location);
                    return null;
                }
                
                // 2. Obtener pron√≥stico con las coordenadas (7 d√≠as)
                const forecastUrl = `https://api.open-meteo.com/v1/forecast?latitude=${coordinates.latitude}&longitude=${coordinates.longitude}&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_sum,precipitation_probability_max&timezone=auto&forecast_days=7`;
                
                const response = await fetch(forecastUrl);
                
                if (!response.ok) {
                    throw new Error(`Error obteniendo pron√≥stico: ${response.status}`);
                }
                
                const forecastData = await response.json();
                console.log("Datos de pron√≥stico:", forecastData);
                
                // A√±adir informaci√≥n de ubicaci√≥n al pron√≥stico
                return {
                    ...forecastData,
                    location: coordinates
                };
                
            } catch (error) {
                console.error("Error detallado:", error);
                return null;
            }
        }

        // Traducir c√≥digos de condici√≥n clim√°tica WMO (World Meteorological Organization)
        function translateWeatherCode(code) {
            const weatherCodes = {
                0: "Cielo despejado",
                1: "Mayormente despejado",
                2: "Parcialmente nublado",
                3: "Nublado",
                45: "Niebla",
                48: "Niebla con escarcha",
                51: "Llovizna ligera",
                53: "Llovizna moderada",
                55: "Llovizna intensa",
                56: "Llovizna helada ligera",
                57: "Llovizna helada densa",
                61: "Lluvia ligera",
                63: "Lluvia moderada",
                65: "Lluvia intensa",
                66: "Lluvia helada ligera",
                67: "Lluvia helada intensa",
                71: "Nevada ligera",
                73: "Nevada moderada",
                75: "Nevada intensa",
                77: "Aguanieve",
                80: "Lluvia ligera intermitente",
                81: "Lluvia moderada intermitente",
                82: "Lluvia intensa intermitente",
                85: "Nevada ligera intermitente",
                86: "Nevada intensa intermitente",
                95: "Tormenta el√©ctrica",
                96: "Tormenta con granizo ligero",
                99: "Tormenta con granizo intenso"
            };
            
            return weatherCodes[code] || "Condici√≥n desconocida";
        }

        // Obtener informaci√≥n clim√°tica actual
        async function getWeatherInformation(location) {
            try {
                addMessage(`Buscando informaci√≥n clim√°tica para ${location}...`, true);
                
                // Obtener datos del clima
                const weatherData = await fetchWeatherData(location);
                
                if (!weatherData || !weatherData.current) {
                    return `Lo siento, no pude encontrar informaci√≥n clim√°tica para "${location}". Por favor, verifica el nombre de la ubicaci√≥n.`;
                }
                
                




                // Extraer datos relevantes
                const current = weatherData.current;
                const locationName = weatherData.location.name;
                const country = weatherData.location.country;
                const region = weatherData.location.admin1 || "";
                
                const temp = Math.round(current.temperature_2m);
                const feelsLike = Math.round(current.apparent_temperature);
                const humidity = current.relative_humidity_2m;
                const windSpeed = Math.round(current.wind_speed_10m * 3.6); // convertir a km/h
                const condition = translateWeatherCode(current.weather_code);
                const precipitation = current.precipitation;
                
                // Fecha y hora local
                const now = new Date();
                const day = now.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric', month: 'long' });
                
                // Crear mensaje de respuesta sin iconos
                return `El clima actual para ${locationName}, ${region ? region + ", " : ""}${country} - ${day}:
                
Temperatura: ${temp}¬∞C (Sensaci√≥n t√©rmica: ${feelsLike}¬∞C)
Condici√≥n: ${condition}
Humedad: ${humidity}%
Precipitaci√≥n: ${precipitation} mm
Viento: ${windSpeed} km/h`;
                
            } catch (error) {
                console.error("Error al obtener informaci√≥n del clima:", error);
                return `Lo siento, hubo un problema al consultar el clima para ${location}. Por favor, intenta m√°s tarde.`;
            }
        }

        // Obtener pron√≥stico para varios d√≠as
        async function generateForecastWeather(location) {
            try {
                addMessage(`Buscando pron√≥stico para ${location}...`, true);
                
                // Obtener datos del pron√≥stico
                const forecastData = await fetchForecastData(location);
                
                if (!forecastData || !forecastData.daily) {
                    return `Lo siento, no pude encontrar el pron√≥stico para "${location}". Por favor, verifica el nombre de la ubicaci√≥n.`;
                }
                
                // Extraer datos relevantes
                const daily = forecastData.daily;
                const locationName = forecastData.location.name;
                const country = forecastData.location.country;
                
                // Crear mensaje de pron√≥stico
                let forecastText = `Pron√≥stico para ${locationName}, ${country} en los pr√≥ximos d√≠as:\n\n`;
                
                // Generar pron√≥stico para los d√≠as disponibles (hasta 5)
                const maxDays = Math.min(5, daily.time.length);
                
                for (let i = 0; i < maxDays; i++) {
                    const date = new Date(daily.time[i]);
                    const dayName = date.toLocaleDateString('es-ES', { weekday: 'long', day: 'numeric' });
                    
                    const minTemp = Math.round(daily.temperature_2m_min[i]);
                    const maxTemp = Math.round(daily.temperature_2m_max[i]);
                    const condition = translateWeatherCode(daily.weather_code[i]);
                    const precipitation = daily.precipitation_sum[i];
                    const precipitationProb = daily.precipitation_probability_max ? daily.precipitation_probability_max[i] : "N/A";
                    
                    forecastText += `${dayName}: ${condition}.\n`;
                    forecastText += ` Temperatura: ${minTemp}¬∞C a ${maxTemp}¬∞C\n`;
                    forecastText += ` Precipitaci√≥n: ${precipitation} mm`;
                    
                    if (precipitationProb !== "N/A") {
                        forecastText += ` (Probabilidad: ${precipitationProb}%)`;
                    }
                    
                    forecastText += "\n\n";
                }
                
                return forecastText;
                
            } catch (error) {
                console.error("Error al obtener pron√≥stico:", error);
                return `Lo siento, hubo un problema al consultar el pron√≥stico para ${location}. Por favor, intenta m√°s tarde.`;
            }
        }

        // Funci√≥n para texto a voz
        function speakText(text) {
            if (isMuted || !speech) return;
            
            try {
                speech.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 1.0;
                speech.speak(utterance);
            } catch (e) {
                console.log('Error en s√≠ntesis de voz:', e);
            }
        }
        
        // Agregar mensaje al chat
        function addMessage(text, isBot = false) {
            const msgDiv = document.createElement('div');
            msgDiv.classList.add(isBot ? 'bot-message' : 'user-message');
            msgDiv.textContent = text;
            chatbox.appendChild(msgDiv);
            chatbox.scrollTop = chatbox.scrollHeight;
            
            if (isBot) {
                speakText(text);
            }
        }
        
        // Funci√≥n mejorada para detectar consultas de clima
        function isWeatherQuery(text) {
            const weatherKeywords = [
                'clima', 'tiempo', 'temperatura', 'lluvia', 'llover', 'pronostico', 
                'pron√≥stico', 'meteorolog√≠a', 'meteorol√≥gico', 'sol', 'calor', 
                'fr√≠o', 'frio', 'nublado', 'precipitaci√≥n', 'meteo', 'viento'
            ];
            
            const lowerText = text.toLowerCase();
            
            for (const keyword of weatherKeywords) {
                if (lowerText.includes(keyword)) {
                    return true;
                }
            }
            
            return false;
        }
        
        // Funci√≥n mejorada para extraer la ubicaci√≥n
        function extractLocation(text) {
            const lowerText = text.toLowerCase();
            
            // Si la consulta es muy corta, puede ser directamente el nombre de la ciudad
            if (lowerText.split(' ').length <= 3) {
                // Verificar que no sea solo una palabra de clima
                const weatherTerms = ['clima', 'tiempo', 'lluvia', 'sol', 'nublado'];
                const words = lowerText.split(' ');
                
                if (words.length === 1 && !weatherTerms.includes(words[0])) {
                    return text.trim();
                }
            }
            
            if (isWeatherQuery(text)) {
                const patterns = [
                    /clima (?:en|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,                  
                    /tiempo (?:en|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,                 
                    /pron√≥stico (?:de|para|en) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,        
                    /pronostico (?:de|para|en) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,        
                    /(?:c√≥mo|como) (?:est√°|estar√°|es|sera) el clima (?:en|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,  
                    /(?:va a|va|habr√°|hay|har√°) (?:llover|lluvia|sol|calor|fr√≠o|frio) (?:en|hoy en) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,  
                    /temperatura (?:en|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,           
                    /clima (?:para|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,               
                    /(?:el|la) (?:clima|tiempo|temperatura) (?:en|de) ([\w√°√©√≠√≥√∫√º√±\s]+)/i, 
                    /(?:qu√©|que) (?:clima|tiempo) (?:hace|hay) (?:en|hoy en) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,
                    /(?:ciudad|en) ([\w√°√©√≠√≥√∫√º√±\s]+)/i,
                    // Patr√≥n para capturar la √∫ltima parte de la frase
                    /(\b[\w√°√©√≠√≥√∫√º√±\s]{2,})\s*$/i
                ];
                
                for (const pattern of patterns) {
                    const match = text.match(pattern);
                    if (match && match[1]) {
                        const location = match[1].trim().replace(/[?.,;!]/g, '');
                        console.log("Ubicaci√≥n extra√≠da:", location);
                        return location;
                    }
                }
                
                // Si no se encontr√≥ un patr√≥n, intentar identificar una ciudad usando palabras comunes
                const words = lowerText.replace(/[?.,;!]/g, '').split(' ');
                if (words.length > 0) {
                    const commonWords = ['clima', 'tiempo', 'el', 'la', 'en', 'de', 'pronostico', 'pron√≥stico', 
                                       'temperatura', 'hace', 'hay', 'va', 'para', 'hoy', 'ma√±ana', 
                                       'lluvia', 'llover', 'sol', 'calor', 'frio', 'fr√≠o', 'me', 'puedes', 'decir',
                                       'como', 'c√≥mo', 'est√°', 'esta', 'del', 'actual', 'ahora'];
                    
                    // Buscar palabras que no sean comunes y sean potenciales ciudades
                    const potentialCities = [];
                    for (let i = 0; i < words.length; i++) {
                        if (!commonWords.includes(words[i]) && words[i].length > 2) {
                            potentialCities.push(words[i]);
                        }
                    }
                    
                    // Si hay ciudades potenciales, tomar la √∫ltima (suele ser la ciudad en preguntas)
                    if (potentialCities.length > 0) {
                        const city = potentialCities[potentialCities.length - 1];
                        console.log("Ciudad potencial:", city);
                        return city.charAt(0).toUpperCase() + city.slice(1);
                    }
                }
            }
            return null;
        }

        // Funci√≥n para buscar en Wikipedia
        async function searchWikipedia(query) {
            try {
                const response = await fetch(`https://es.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(query)}&utf8=&format=json&origin=*`);
                
                if (!response.ok) {
                    throw new Error(`Error en la b√∫squeda de Wikipedia: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.query.search.length > 0) {
                    const pageTitle = data.query.search[0].title;
                    const pageResponse = await fetch(`https://es.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(pageTitle)}&prop=extracts&exintro&explaintext&format=json&origin=*`);
                    const pageData = await pageResponse.json();
                    const pageId = Object.keys(pageData.query.pages)[0];
                    const content = pageData.query.pages[pageId].extract;
                    
                    return {
                        title: pageTitle,
                        content: content
                    };
                }
                
                return null;
            } catch (error) {
                console.error("Error al buscar en Wikipedia:", error);
                return null;
            }
        }

        // Procesar el mensaje del usuario y generar respuesta
        async function processMessage(text) {
            if (!text.trim()) return;
            
            // Si estamos esperando el nombre del usuario
            if (waitingForName) {
                userName = text.trim();
                waitingForName = false;
                addMessage(`¬°Hola ${userName}! Soy el asistente virtual especializado en cuencas hidrol√≥gicas. Puedes preguntarme sobre temas como ciclo hidrol√≥gico, erosi√≥n, tipos de cuencas o incluso consultar el clima de cualquier lugar. ¬øEn qu√© puedo ayudarte hoy?`, true);
                return;
            }
            
            // Convertir texto a min√∫sculas para comparaciones
            const lowerText = text.toLowerCase();
            
            // Verificar si es una consulta de clima
            if (isWeatherQuery(lowerText)) {
                const location = extractLocation(text);
                if (location) {
                    // Determinar si es pron√≥stico a futuro o clima actual
                    if (lowerText.includes("pron√≥stico") || lowerText.includes("pronostico") || 
                        lowerText.includes("pr√≥ximos d√≠as") || lowerText.includes("proximos dias") || 
                        lowerText.includes("semana") || lowerText.includes("ma√±ana")) {
                        const forecast = await generateForecastWeather(location);
                        addMessage(forecast, true);
                    } else {
                        const weatherInfo = await getWeatherInformation(location);
                        addMessage(weatherInfo, true);
                    }
                    return;
                }
            }
            
            // Buscar en la base de conocimiento hidrol√≥gico
            for (const [keyword, info] of Object.entries(hydrologicalKnowledge)) {
                if (lowerText.includes(keyword)) {
                    addMessage(info, true);
                    return;
                }
            }
            
            // Si no encontramos una respuesta espec√≠fica, buscar en Wikipedia
            addMessage("Buscando informaci√≥n relevante en Wikipedia...", true);
            isSearching = true;
            
            const wikiResult = await searchWikipedia(text);
            
            if (wikiResult) {
                const message = `Informaci√≥n sobre "${wikiResult.title}":\n\n${wikiResult.content}\n\nPuedes consultar m√°s informaci√≥n en Wikipedia.`;
                addMessage(message, true);
            } else {
                addMessage("Lo siento, no encontr√© informaci√≥n espec√≠fica sobre tu consulta. ¬øPuedes reformularla o preguntar sobre otro tema relacionado con hidrolog√≠a o cuencas?", true);
            }
            
            isSearching = false;
        }
        
        // Funci√≥n para enviar mensaje
        function sendMessage() {
            const message = userInput.value.trim();
            if (message) {
                addMessage(message, false);
                processMessage(message);
                userInput.value = '';
            }
        }
        
        // Evento para bot√≥n de enviar
        sendBtn.addEventListener('click', sendMessage);
        
        // Evento para enviar con Enter
        userInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Evento para bot√≥n de reiniciar
        resetBtn.addEventListener('click', function() {
            chatbox.innerHTML = '';
            waitingForName = true;
            addMessage("¬°Hola! Soy el asistente virtual de cuencas hidrol√≥gicas. ¬øCu√°l es tu nombre?", true);
        });
        
        // Evento para bot√≥n de silenciar
        muteBtn.addEventListener('click', function() {
            isMuted = !isMuted;
            this.textContent = isMuted ? "Activar voz" : "Silenciar";
            if (isMuted) {
                speech.cancel();
            }
        });
        
        // Evento para bot√≥n del micr√≥fono
        micBtn.addEventListener('click', function() {
            if (!recognition) {
                alert('Lo sentimos, el reconocimiento de voz no es compatible con este navegador.');
                return;
            }
            
            try {
                if (this.classList.contains('listening')) {
                    recognition.stop();
                    this.classList.remove('listening');
                    userInput.placeholder = "Escribe tu mensaje aqu√≠...";
                } else {
                    recognition.start();
                    this.classList.add('listening');
                    userInput.placeholder = "Escuchando...";
                }
            } catch(e) {
                console.error('Error al activar el micr√≥fono:', e);
            }
        });
        
        // Evento para bot√≥n de cuencas de M√©xico
        document.getElementById('mexicoBasinsBtn').addEventListener('click', function() {
            getMexicanWatersheds();
        });
        
        // Iniciar el chat
        window.onload = function() {
            addMessage("¬°Hola! Soy el asistente virtual de cuencas hidrol√≥gicas. ¬øCu√°l es tu nombre?", true);
        };
    </script>
</body>
</html>

